sql = f"select o.id, o.user_id, date(o.created_at) as placed_at, o.is_rebill, ss.value as deadline, x.value as al, z.value as subject, (select count(f.id) from files f  left join optionables op on op.optionable_id = f.id  where f.order_id = o.id and op.option_value_id = 127) as materials_num, if(o.pages > 0, o.pages, ceiling(o.word_count/if(ii.value = 'single', 550, if(ii.value = '1.5 lines', 400, 275)) ) ) as pages, oa.name as site, j.value as order_status, (select a.assigned_user_id from assignments a  where a.confirmed_by_writer = 1  and a.assigned_user_id is not null  and a.order_id = o.id limit 1) as writer_id from orders o  left join optionables op on op.optionable_id = o.id  left join users u on u.id = o.user_id   left join (select op.optionable_id as id, ov.value as value from optionables op     inner join option_values ov       on ov.id = op.option_value_id   where op.option_id = 1 and op.deleted_at is null) as ss on ss.id = o.id  left join (select op.optionable_id as id, ov.value as value from optionables op   inner join option_values ov on ov.id = op.option_value_id  where op.option_id = 2) as x on x.id = o.id  left join (select op.optionable_id as id, ov.value as value from optionables op     inner join option_values ov on ov.id = op.option_value_id where op.option_id = 9) as z on z.id = o.id  left join (select op.optionable_id as id,    ov.value as value from optionables op    inner join option_values ov on ov.id = op.option_value_id  where op.option_id = 10) as ii on ii.id = o.id  left join (select op.optionable_id as id,    ov.value as value from optionables op     inner join option_values ov on ov.id = op.option_value_id  where op.option_id = 14) as j on j.id = o.id     left join oauth_clients oa on oa.id = u.app_id  where op.option_value_id = 119 and op.deleted_at is null  and o.is_test = 0 and u.is_test = 0  and o.is_duplicate = 0  and date(o.created_at) >= '{START_DATE}'  and date(o.created_at) <= '{END_DATE}'   and ss.value in ('3 Days', '5 Days', '7 Days',  '9 Days',  '14 Days', '20 Days')  and x.value in ('High School', 'Undergraduate') and z.value in ('Business', 'Marketing', 'Management', 'History', 'Psychology', 'Culture', 'Communication', 'Education', 'Sociology') and (select count(f.id) from files f  left join optionables op on op.optionable_id = f.id  where f.order_id = o.id and op.option_value_id = 127) in (0,1,2,3)  order by   date(o.created_at) asc"
  
Cursor.execute(sql);
k1 = pd.read_sql_query(sql, connection)
